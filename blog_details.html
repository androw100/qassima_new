<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تفاصيل المدونة</title>
</head>

<body>
    <div id="blog-details">
        <!-- سيتم عرض تفاصيل المدونة هنا -->
    </div>

    <script>
        // استرجاع الـ id من localStorage
        const blogId = localStorage.getItem('selectedBlogId');

        async function fetchBlogDetails(id) {
            try {
                const response = await fetch(`https://qasimahapp.com/api/blog/${id}`);
                if (!response.ok) {
                    throw new Error("Network response was not ok " + response.statusText);
                }
                // قراءة النص بدلاً من JSON مباشرة
                const text = await response.text();

                // محاولة تحويل النص إلى JSON
                try {
                    const data = JSON.parse(text);
                    if (data && data.data) {
                        displayBlogDetails(data.data);
                    } else {
                        console.error("No data found in response");
                    }
                } catch (jsonError) {
                    // إذا فشل التحويل إلى JSON، اعرض النص كما هو
                    document.getElementById('blog-details').innerText = "Received non-JSON response.";
                    console.error("Error parsing JSON:", jsonError);
                }
            } catch (error) {
                console.error("Error fetching blog details:", error);
                document.getElementById('blog-details').innerText = "Error loading blog details.";
            }
        }

        function displayBlogDetails(blog) {
            const blogDetailsElement = document.getElementById("blog-details");
            if (blogDetailsElement) {
                blogDetailsElement.innerHTML = `
                    <h1>${blog.title}</h1>
                    <img src="${blog.image}" class="img-fluid" alt="${blog.title}" />
                    <p>${blog.notes}</p>
                `;
            } else {
                console.error('Element with id "blog-details" not found');
            }
        }

        // تأكد من وجود id قبل محاولة جلب البيانات
        if (blogId) {
            fetchBlogDetails(blogId);
        } else {
            console.error('No blog ID found in storage');
            document.getElementById('blog-details').innerText = "No blog selected.";
        }
    </script>
</body>

</html>